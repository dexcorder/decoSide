<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>토글 가능한 사이드바</title>
<style>

/* 전체 컨테이너 설정 */
body, html {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  display: flex;
}

/* 사이드바 컨테이너 */
.sidebar-container {
  display: flex;
  flex-direction: column;
  width: 250px;
  height: 100%;
  transition: margin-left 0.4s ease, opacity 0.7s ease-in-out; /* margin-left로 애니메이션 효과 적용 */
  opacity: 1;
}

.sidebar-container.collapsed {
  margin-left: -220px; /* 사이드바가 닫힐 때의 위치 */
}

/* 사이드바 스타일 */
.sidebar {
  background-color: #333;
  color: #fff;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 10px;
  overflow: hidden;
  width: 230px;
}

/* 토글 버튼 스타일 */
.toggle-btn {
  background: none;
  border: none;
  color: #fff;
  font-size: 24px;
  cursor: pointer;
  margin-bottom: 20px;
  align-self: flex-end; /* 사이드바 오른쪽 상단에 배치 */
}
/* 사이드바 iframe 스타일 */
.sidebar {
  width: 250px;
  height: 100%;
  border: none;
}
.sidebar.collapsed {
  width: 50px; /* 닫힐 때의 너비 */
}

.menu-item {
    margin-bottom: 10px;
    width: 100%;
}

/* 기본 서브메뉴 스타일: 숨김 */
.submenu {
    padding-left: 30px;
    max-height: 0; /* 초기 상태: 높이 0 */
    overflow: hidden; /* 넘침 방지 */
    opacity: 0; /* 투명도 0으로 설정 */
    transition: all 0.4s ease; /* 높이와 투명도 조정 애니메이션 */
}
/* 서브메뉴가 열렸을 때 */
.submenu.open {
    max-height: 200px; /* 적절한 최대 높이 설정 (서브메뉴 항목 길이에 맞춰 늘어남) */
    opacity: 1; /* 서브메뉴 보이도록 */
}

.submenu a {
    display: block;
    color: rgba(255, 255, 255, 0.72);
    text-decoration: none;
    padding: 5px 0;
}

.submenu a:hover {
    background-color: #575757;
    color: #fff;
}

/* 메뉴 항목 기본 스타일 */
.menu-item > a {
    display: block;
    text-decoration: none;
    font-weight: bold;
    border-radius: 5px;
    color: #ddd;
    font-size: 18px;
    padding: 10px 15px; /* 고정된 패딩으로 크기 유지 */
    transition: background-color 0.4s ease, color 0.4s ease; /* 배경색과 텍스트 색상 전환 애니메이션 */
}

.menu-item > a:hover {
    background-color: #575757;
    color: #fff;
}
/* 화살표 아이콘 */
.menu-item > a::after {
    content: '▼';
    float: right;
    font-size: 12px;
    transition: transform 0.3s; /* 화살표 회전 효과 */
}
/* 서브메뉴가 없는 경우 화살표를 숨김 */
.menu-item.no-submenu > a::after {
    content: ''; /* 화살표 제거 */
}
/* 서브메뉴 열림 상태일 때 화살표 회전 */
.menu-item > a.open::after {
    transform: rotate(-180deg); /* 열렸을 때 화살표 위로 */
}

</style>
</head>
<body>

  <!-- 사이드바 컨테이너 -->
  <div class="sidebar-container" id="sidebar_container">
    <!-- 사이드바 -->
    <div class="sidebar" id="sidebar">
        <!-- 토글 버튼 -->
        <button class="toggle-btn" onclick="toggleSidebar()" id="toggle-btn">&#9776;</button>
        <!-- 홈 -->
        <div class="menu-item">
            <a href="#">홈</a>
        </div>

        <!-- 소개 -->
        <div class="menu-item">
            <a href="#">소개</a>
            <div class="submenu">
                <a href="#">회사 개요</a>
                <a href="#">팀 소개</a>
                <a href="#">역사</a>
            </div>
        </div>

        <!-- 서비스 -->
        <div class="menu-item">
            <a href="#">서비스</a>
            <div class="submenu">
                <a href="#">웹 개발</a>
                <a href="#">모바일 앱</a>
                <a href="#">SEO</a>
            </div>
        </div>

        <!-- 연락처 -->
        <div class="menu-item">
            <a href="#">연락처</a>
            <div class="submenu">
                <a href="#">문의하기</a>
                <a href="#">찾아오시는 길</a>
            </div>
        </div>
    </div>
</div>

<script>

  // 사이드바 토글 함수
  const TOGGLED_WIDTH = 50;
  const UNTOGGLED_WIDTH = 300;

  function toggleSidebar() {
      const parentDocument = window.parent.document;
      const sidebarIframe = parentDocument.querySelector("iframe.sidebar") ?? parentDocument.querySelector("#sidebar_container");
      const sidebarContainer = document.getElementById("sidebar_container");
      const toggleBtn = document.getElementById("toggle-btn");

      // 사이드바와 아이콘 업데이트
      const isCollapsed = sidebarContainer.classList.toggle("collapsed");
      sidebarIframe.classList.toggle("collapsed");
      updateSidebarStyle(isCollapsed, sidebarIframe, toggleBtn);
  }

  function updateSidebarStyle(isCollapsed, sidebarIframe, toggleBtn) {
      const newWidth = isCollapsed ? TOGGLED_WIDTH : UNTOGGLED_WIDTH;
      applySidebarTransition(sidebarIframe, newWidth);
  }

  function applySidebarTransition(sidebarIframe, width) {
      // 강제 리페인트를 위해 트릭 사용
      sidebarIframe.style.width = sidebarIframe.offsetWidth + "px"; // 리페인트 강제 수행
      requestAnimationFrame(() => {
          sidebarIframe.style.transition = "width 0.4s ease";
          sidebarIframe.style.width = width + "px";
      });
  }

  window.addEventListener('DOMContentLoaded', () => {
      const sidebarContainer = document.querySelector('#sidebar_container');
      const menuItems = document.querySelectorAll(".menu-item");

      menuItems.forEach(item => {
          const submenu = item.querySelector(".submenu");

          // 서브메뉴가 없는 경우 no-submenu 클래스 추가
          if (!submenu) {
              item.classList.add("no-submenu");
          }

          // 서브메뉴가 있는 경우 클릭 시 토글 이벤트 추가
          const link = item.querySelector("a");
          if (submenu) {
              link.addEventListener("click", function (e) {
                  e.preventDefault(); // 링크 기본 동작 방지
                  submenu.classList.toggle("open");
                  link.classList.toggle("open");
              });
          }
      });
  });

</script>

</body>
</html>